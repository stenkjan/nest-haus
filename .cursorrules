# Project Rules for Nest-Haus Configurator

## Essential Project Rules

- keep the code slim and efficient, dont use fixed dimensions and static sizes, never change any design properties or specifications without asking if they are not in direct relation to the prompt.
  Make sure to not make unneccessary api calls, always ask yourself what the minimu amount of reasonable call to an api for a specific request is.
- global project rules

## Rule Documentation Structure

This project uses a modular rule system organized in `.mdc` files for better maintainability and Cursor integration:

### **üìã Development & Technical Rules**

**File**: `docs/development-rules.mdc`

- Code quality & documentation standards
- TypeScript & type safety requirements
- Testing & verification guidelines
- Terminal & PowerShell usage (Windows environment)
- Prisma database management
- API testing & debugging with cURL
- Git & line ending configuration
- Error handling & debugging patterns

### **üèóÔ∏è Architecture & Design Rules**

**File**: `docs/architecture-design-rules.mdc`

- Folder structure & organization (React/Next.js best practices)
- SectionRouter navigation architecture (mandatory for content pages)
- Responsive design guidelines
- DOM features & sizing patterns
- Landing page image handling (specific rules)

### **‚ö° Performance & Rendering Rules**

**File**: `docs/performance-rendering-rules.mdc`

- SSR vs Client-side rendering strategy
- Image optimization & handling system
- Performance requirements & monitoring
- Caching strategies (multi-level)
- Next.js configuration standards

### **üóÑÔ∏è Database & Backend Rules**

**File**: `docs/database-backend-rules.mdc`

- Architecture constraints & integration guidelines
- Session lifecycle management
- Prisma error handling patterns
- Race condition prevention
- Configurator architecture patterns
- State management with Zustand

## Quick Reference Commands

### Server Management

```bash
# Check if server is running
netstat -an | findstr :3000

# Start development server (background)
npm run dev
```

### Prisma Operations

```bash
# Regenerate client after schema changes
npx prisma generate

# Sync schema to database
npx prisma db push

# Test database connection
curl -s "http://localhost:3000/api/test/db"
```

### API Testing

```bash
# Basic API test
curl -s "http://localhost:3000/api/endpoint"

# Format JSON response
curl -s "http://localhost:3000/api/endpoint" | python -m json.tool
```

## Critical Patterns

### TypeScript Safety

- **NEVER use `any` type** - always specify proper types
- Use `unknown` over `any` when type is truly unknown
- Implement proper type guards and assertions

### Component Architecture

- Route-specific code stays in `src/app/ROUTE/`
- Shared components go in `src/components/`
- Use SectionRouter for all multi-section content pages

### Performance Priority

- Price calculations: CLIENT-SIDE (sub-100ms)
- Session tracking: Background, non-blocking
- API calls: Optimistic, fail-safe
- Images: Use `HybridBlobImage` with proper caching

### Database Operations

- Always use `upsert()` for session operations
- Handle race conditions and missing records gracefully
- Never block user experience waiting for database operations

---

**üìñ For detailed implementation guidelines, refer to the specific `.mdc` files listed above.**
